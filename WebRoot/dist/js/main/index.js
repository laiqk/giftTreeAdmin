/*! XMAdmin2016 v0.0.1 | (c) 2015 Jerry */
define("main/index",["jQuery","log","tab","editor","mousewheel","template","libs/templateLib","main/index-chart"],function(e){var t=e("jQuery"),n=e("log"),a=e("tab");e("editor");n.$();var i=n.log;e("mousewheel");var r=e("template"),o=e("libs/templateLib");window.template=r,i("artTemplate is loaded, version:",r.version);var l=800,g=t(window).height(),u=t("ul.nav-menu").height(),m=t("ul.nav-menu>li").height(),s={},d=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],c=function(){if(!(t("#page-index").length<=0)){var e=(t(window).height()-t("#page-index > .arrow-btn-left").height())/2-115+t(window).scrollTop();t("#page-index > .arrow-btn-left").css({top:e});var n=(t(window).height()-t("#page-index > .arrow-btn-right").height())/2-115+t(window).scrollTop(),a=t(window).width()-86-311-t("#page-index > .arrow-btn-right").height();t("#page-index > .arrow-btn-right").css({top:n,left:a})}},p=function(){var e=t(window).width()-311-86;t("#page-index > .arrow-btn-left").on("click",function(n){var a=parseInt(t("#page-index").css("margin-left")),i=a+e>=0?0:a+e;t("#page-index").stop(!0).animate({"margin-left":i},1500)}),t("#page-index > .arrow-btn-right").on("click",function(n){var a=parseInt(t("#page-index").css("margin-left")),i=a-e<=e-t("#page-index").width()?e-t("#page-index").width():a-e;t("#page-index").stop(!0).animate({"margin-left":i},1500)}),t("#page-index").on("mousewheel",function(e){-1===e.deltaY?t("#page-index > .arrow-btn-right").trigger("click"):1===e.deltaY&&t("#page-index > .arrow-btn-left").trigger("click"),e.preventDefault()})},w=function(){t("#main-content").css({width:t(window).width()-311-86}),g=t(window).height(),u+60>g?(t("ul.nav-menu").addClass("small"),t(".arrow-up-btn, .arrow-down-btn").stop(!0,!0).slideDown("slow")):(t("ul.nav-menu").removeClass("small"),t(".arrow-up-btn, .arrow-down-btn").stop(!0,!0).slideUp("slow")),g=(parseInt(g/m)-1)*m,c()},v=function(){var e=new Date,n=e.getHours()>9?e.getHours():"0"+e.getHours(),a=e.getMinutes()>9?e.getMinutes():"0"+e.getMinutes(),i=d[e.getDay()],r=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate();t("#time>.hour").text()!==n.toString()&&t("#time>.hour").text(n),t("#time>.minute").text()!==a.toString()&&t("#time>.minute").text(a),t("#day").text()!==i&&t("#day").text(i),t("#date").text()!==r&&t("#date").text(r)},h=function(){t(".arrow-up-btn").on("click",function(){var e=parseInt(t("ul.nav-menu").css("margin-top")),n=e+g>0?0:e+g;t("ul.nav-menu").stop(!0).animate({"margin-top":n+"px"},l)}),t(".arrow-down-btn").on("click",function(){var e=parseInt(t("ul.nav-menu").css("margin-top")),n=g-u>=e-g?g-u:e-g;t("ul.nav-menu").stop(!0).animate({"margin-top":n+"px"},l)}),t("ul.nav-menu").on("mousewheel",function(e){-1===e.deltaY?t(".arrow-down-btn").trigger("click"):1===e.deltaY&&t(".arrow-up-btn").trigger("click"),e.preventDefault()})},f=function(){t(".nav-menu>.nav-menu-item").on("click",function(){var e=t(this).data("item");return 5===e?void b():(t('.nav-sub-menu[data-item="'+e+'"]').toggle(),void t('.nav-sub-menu[data-item="'+e+'"]').siblings(".nav-sub-menu").hide())})},x=function(e,n){var i=o.getPageIndexByName(e),r="number"==typeof n&&n>0?n:1,l=function(n,o){o===!0?t("#main-content").html(n):(t("#main-content").html(n),s[e]=n),new a,t("#page-"+e+">.tab>.tab-hd>.item").eq(r-1).trigger("click"),t(".nav-menu-item[data-item="+i+"]").addClass("active").siblings(".nav-menu-item").removeClass("active")};if(t("#page-"+e).length>0)t("#page-"+e+">.tab>.tab-hd>.item").eq(r-1).trigger("click");else if("string"!=typeof s[e]){var g=o.getPageLink(e);t.ajax({url:g,type:"get",dataType:"html",success:function(e){l(e)}})}else l(s[e])},b=function(){var n=e("main/index-chart"),a=function(e,a){a===!0?t("#main-content").html(e):(t("#main-content").html(e),s.index=e),c(),p(),t(".nav-menu-item[data-item=5]").addClass("active").siblings(".nav-menu-item").removeClass("active"),t(".nav-sub-menu").hide(),n(),t("#page-index").css({"margin-left":-1010})};if(t("#page-index").length>0);else if("string"!=typeof s.index){var i=o.getPageLink("index");t.ajax({url:i,type:"get",dataType:"html",success:function(e){a(e)}})}else a(s.index,!0)};t(function(){w(),t(window).on("resize",w),t(window).on("scroll",function(){c()});setInterval(function(){v()},1e3);h(),f(),t(".nav-sub-menu[data-item]>ul>li>a").on("click",function(){var e=t(this).parents(".nav-sub-menu").data("item"),n=t(this).data("item"),a=o.getPageByIndex(e-1);i("This item:",e,a),x(a,n);var r=ROOT_URL+"/?page="+a+"&tabIndex="+n;i("当前页面URL:",r)});var e=o.getPageIndexByName(PA.page);"number"!=typeof e&&(e=5),5===e?t(".nav-menu>li[data-item=5]").trigger("click"):(t(".nav-menu>li[data-item="+e+"]").trigger("click"),t(".nav-sub-menu[data-item="+e+"]>ul>li>a").eq(PA.tabIndex-1).trigger("click"))})});