/*! XMAdmin2016 v0.0.1 | (c) 2015 Jerry */
define("modules/validator",["jQuery","utils","log","i18n/{locate}/user"],function(e,t,n){"use strict";var r=e("jQuery"),s=e("utils"),a=e("log"),i=a.log,u=a.error,o=a.warn;e("i18n/{locate}/user");if("undefined"==typeof r||"undefined"==typeof r.fn||"string"!=typeof r.fn.jquery)return void u("Can not find jQuery.");a.$(),i("Module Validator is loading...");var l=/\s/,d=/^\d+$/,m=/^[a-zA-Z]+$/,f=s.setReturnJson,p={username:function(e,t,n){var r=this.usernameRules,a=s.inRange(e,r.min,r.max);return a.status?f(!0):a},password:function(e,t,n){var r=this.passwordRules,a=s.trim(e),i=s.inRange(a,r.min,r.max);return i.status?r.hasBlank&&l.test(a)?f(!1,"密码不能含有空格"):r.onlyNumber&&d.test(a)?f(!1,"密码不能为纯数字"):r.onlyLetter&&m.test(a)?f(!1,"密码不能为纯字母"):f(!0):i},repassword:function(e,t,n,r){var a=this.passwordRules,u=s.trim(e),p=r.val().trim();if(0===r.length)return o("Can not find password input"),f(!1,"");var c=this.password(r.val(),this,r);if(!c.status)return i(c),f(!1,"");var h=s.inRange(u,a.min,a.max);return h.status?a.hasBlank&&!l.test(u)?f(!1,"密码不能含有空格"):a.onlyNumber&&!d.test(u)?f(!1,"密码不能为纯数字"):a.onlyLetter&&!m.test(u)?f(!1,"密码不能为纯字母"):p!==u?f(!1,"两次密码不一致"):f(!0):h},telphone:function(e,t,n){if(e=e.trim(),s.isEmpty(e))return f(!1,"手机号不能为空");var r=s.inRange(e,11,11),a=/\d{11}/.test(e);if(!r.status||!a)return f(!1,"手机号格式不正确");s.checkMobile(e);return f(!0)},code:function(e,t,n){return f(!0)},init:function(e){var t={usernameRules:{min:6,max:16},passwordRules:{min:6,max:16,hasBlank:!1,onlyNumber:!1,onlyLetter:!1}};return e=r.extend({},e,t),this.usernameRules=r.extend({},e.usernameRules),this.passwordRules=r.extend({},e.passwordRules),this}};n.exports=function(e){return p.init(e)},i("Module Validator is loaded.")});